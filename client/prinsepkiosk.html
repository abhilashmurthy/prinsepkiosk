<head>
	<title>Prinsep Kiosk Equipment Borrow</title>
</head>

<body>
	{{> navbar}}
	{{#if currentUser}} <!-- Checks if the user has logged in -->
		<h1 class="header">Prinsep Kiosk Room</h1>
		<div class="container">
			{{> page}}
		</div>
	{{else}}
		<h1 class="header">Prinsep Kiosk Room</h1>
		<h2 class="header">Please Log In</h2>
	{{/if}}
</body>

<template name="navbar">
	<div class="navbar navbar-inverse">
		<div class="container navbar-inner">
			<div class="container">
				<a class="brand" href="#">Prinsep Kiosk Duty</a>
				<div class="nav-collapse collapse navbar-inverse-collapse">
					{{loginButtons align="right"}}
				</div>
			</div>
		</div>
	</div>
</template>

<template name="page">
	{{#unless hasRequestedAccess}} <!-- Disable request button if already requested -->
		<button id="requestRSBtn" class="btn btn-success">Request RS Access</button>
	{{/unless}}
	{{#if isHMT}} <!-- Show users only if user is HMT -->
		{{> users}}
	{{/if}}
	{{> items}}
</template>

<template name="users">
	<h2>Users</h2>
	<div class="users">
		<table id="userTable" class="abhitable table table-bordered table-hover">
			<tr><th>Name</th><th>Access Level</th><th>RS Access</th></tr>
			{{#each users}}
				<tr>
					<td><a href="{{services.facebook.link}}">{{services.facebook.name}}</a></td>
					<td>{{accessLevel}}</td>
					<td>
						{{#if requestRSAccess}}
							<button class="approveBtn btn btn-success">Approve RS Access</button>
							<button class="rejectBtn btn btn-danger">Reject RS Access</button>
						{{/if}}
					</td>
				</tr>
			{{/each}}
		</table>
	</div>
</template>

<template name="items">
	<h2>Items</h2>
	{{#if isRS}}
		<button class="createItemBtn btn btn-success">New Item</button>
	{{/if}}
	<div class="items">
		<table id="itemTable" class="abhitable table table-bordered table-hover">
			<tr><th>Name</th><th>Description</th><th>Available</th>{{#if isRS}}{{/if}}<th>Status</th><th>Borrow</th></tr>
			{{#each items}}
				<tr>
					<td>
						{{name}}
						{{#if isRS}}
							<button title="Remove" class="deleteItemBtn iconBtn pull-right btn btn-danger"><i class="fa fa-trash-o fa-white"></i></button>
							<button title="Add One" class="incrementItemBtn iconBtn pull-right btn btn-info"><i class="fa fa-plus fa-white"></i></button>
						{{/if}}
					</td>
					<td>{{description}}</td>
					<td>{{count}}</td>
					<td>
					{{#if available}}
						Available
						{{#each requests}}
							<div class="request">
								<i class="muted" style="text-align: center">Requested by </i>
								<div>
									<a href="{{this.services.facebook.link}}" target="_blank">
										<img src="http://graph.facebook.com/{{this.services.facebook.id}}/picture" title="{{this.services.facebook.name}}"/>
									</a>
								</div>
								<div>
									{{this.services.facebook.name}}
								</div>
							</div>
						{{/each}}
					{{else}}
						<i class="muted">Unavailable</i>
					{{/if}}
					</td>
					<td>
						<button class="{{#if available}}borrowBtn{{/if}} btn btn-success">Borrow</button>
					</td>
				</tr>
			{{/each}}
		</table>
	</div>
</template>

<!-- Modals Only -->
<template name="additem">
	<div class="additem">
		<form id="addform">
			<table class="formtable">
				<tr>
					<td>Name</td>
					<td>
						<input type="text" name="name"/>
					</td>
				</tr>
				<tr><td>Type</td><td>
					<select name="type">
						<option value="electronic">Electronic</option>
						<option value="sport">Sport</option>
						<option value="board">Board</option>
						<option value="event">Event</option>
					</select>
				</td></tr>
				<tr><td>Description</td><td><input type="text" name="description"/></td></tr>
				<tr><td>Price</td><td><input type="text" name="price"/></td></tr>
			</table>
		</form>
	</div>
</template>